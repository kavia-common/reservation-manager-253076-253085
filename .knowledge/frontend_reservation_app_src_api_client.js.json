{"is_source_file": true, "format": "JavaScript", "description": "This file implements a generic API client for a React frontend application. It provides functions to build URLs, make HTTP requests with JSON payloads, handle errors consistently, and include debugging logs based on environment configuration.", "external_files": ["fetch API (built-in browser API)"], "external_methods": ["fetch", "URLSearchParams"], "published": ["getApiBaseUrl", "buildUrl", "get", "post", "patch", "del"], "classes": [], "methods": [{"name": "getApiBaseUrl()", "description": "Returns the API base URL by reading environment variables, prioritizing REACT_APP_API_BASE, then REACT_APP_BACKEND_URL, and removing trailing slashes.", "scope": "", "scopeKind": ""}, {"name": "buildUrl(path, query)", "description": "Constructs a full URL by combining the base URL with a given path and optional query parameters, handling array query values and encoding.", "scope": "", "scopeKind": ""}, {"name": "request(method, path, { query, body, headers } = {})", "description": "Performs an HTTP request with JSON payloads or plain text, normalizing errors, and supporting debug logs.", "scope": "", "scopeKind": ""}, {"name": "sanitizeErrorForLog(err)", "description": "Creates a sanitized, redacted version of error information suitable for debugging logs without exposing PII.", "scope": "", "scopeKind": ""}, {"name": "normalizeError(error, fallback = {})", "description": "Standardizes errors into a consistent shape, providing status, code, message, and optional details.", "scope": "", "scopeKind": ""}, {"name": "normalizeResponseError(res, payload)", "description": "Extracts error details from API responses, handling different error shapes.", "scope": "", "scopeKind": ""}, {"name": "safeDebug(scope, meta = {})", "description": "Logs debug information in a safe, PII-free manner when debugging is enabled.", "scope": "", "scopeKind": ""}, {"name": "trimTrailingSlash(s)", "description": "Removes a trailing slash from a URL string if present.", "scope": "", "scopeKind": ""}, {"name": "normalizePath(p)", "description": "Ensures a URL path begins with a slash.", "scope": "", "scopeKind": ""}, {"name": "get", "description": "Performs an HTTP GET request."}, {"name": "post(path, options = {})", "description": "Performs an HTTP POST request.", "scope": "", "scopeKind": ""}, {"name": "patch(path, options = {})", "description": "Performs an HTTP PATCH request.", "scope": "", "scopeKind": ""}, {"name": "del(path, options = {})", "description": "Performs an HTTP DELETE request.", "scope": "", "scopeKind": ""}], "calls": ["buildUrl", "fetch", "normalizeError", "normalizeResponseError", "safeDebug"], "search-terms": ["API client", "React env variables", "JSON request helpers", "request normalization", "debug logs", "buildApiUrl", "fetch wrapper"], "state": 2, "file_id": 16, "knowledge_revision": 45, "git_revision": "1d7e6c79d8b56a0736aa41766a9951cf20d2fd9a", "revision_history": [{"37": ""}, {"45": "1d7e6c79d8b56a0736aa41766a9951cf20d2fd9a"}], "ctags": [{"_type": "tag", "name": "IS_DEBUG", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^const IS_DEBUG = LOG_LEVEL === \"debug\" || LOG_LEVEL === \"trace\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "LOG_LEVEL", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^const LOG_LEVEL = (process.env.REACT_APP_LOG_LEVEL || \"info\").toLowerCase();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "REDACTED", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^const REDACTED = \"[REDACTED]\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^  const base = {$/", "language": "JavaScript", "kind": "class", "scope": "normalizeError", "scopeKind": "class"}, {"_type": "tag", "name": "buildUrl", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^export function buildUrl(path, query) {$/", "language": "JavaScript", "kind": "function", "signature": "(path, query)"}, {"_type": "tag", "name": "code", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    code: err?.code || undefined,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class"}, {"_type": "tag", "name": "code", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    code: fallback.code || \"UNKNOWN_ERROR\",$/", "language": "JavaScript", "kind": "property", "scope": "normalizeError.base", "scopeKind": "class"}, {"_type": "tag", "name": "del", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^export async function del(path, options = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(path, options = {})"}, {"_type": "tag", "name": "details", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    details: fallback.details || undefined,$/", "language": "JavaScript", "kind": "property", "scope": "normalizeError.base", "scopeKind": "class"}, {"_type": "tag", "name": "getApiBaseUrl", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^export function getApiBaseUrl() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "hasDetails", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    hasDetails: !!err?.details,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    message: fallback.message || (error && error.message) || \"Unexpected error\",$/", "language": "JavaScript", "kind": "property", "scope": "normalizeError.base", "scopeKind": "class"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    message: typeof err?.message === \"string\" ? \"[REDACTED_MESSAGE]\" : undefined,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class"}, {"_type": "tag", "name": "method", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    method,$/", "language": "JavaScript", "kind": "field", "scope": "request.init", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeError", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function normalizeError(error, fallback = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(error, fallback = {})"}, {"_type": "tag", "name": "normalizePath", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function normalizePath(p) {$/", "language": "JavaScript", "kind": "function", "signature": "(p)"}, {"_type": "tag", "name": "normalizeResponseError", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function normalizeResponseError(res, payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(res, payload)"}, {"_type": "tag", "name": "patch", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^export async function patch(path, options = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(path, options = {})"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^export async function post(path, options = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(path, options = {})"}, {"_type": "tag", "name": "request", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^async function request(method, path, { query, body, headers } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(method, path, { query, body, headers } = {})"}, {"_type": "tag", "name": "safe", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^  const safe = {$/", "language": "JavaScript", "kind": "class", "scope": "sanitizeErrorForLog", "scopeKind": "class"}, {"_type": "tag", "name": "safeDebug", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function safeDebug(scope, meta = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(scope, meta = {})"}, {"_type": "tag", "name": "sanitizeErrorForLog", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function sanitizeErrorForLog(err) {$/", "language": "JavaScript", "kind": "function", "signature": "(err)"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    status: typeof err?.status === \"number\" ? err.status : undefined,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^    status: typeof fallback.status === \"number\" ? fallback.status : 500,$/", "language": "JavaScript", "kind": "property", "scope": "normalizeError.base", "scopeKind": "class"}, {"_type": "tag", "name": "trimTrailingSlash", "path": "/home/kavia/workspace/code-generation/reservation-manager-253076-253085/frontend_reservation_app/src/api/client.js", "pattern": "/^function trimTrailingSlash(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}], "hash": "ebb24df8d6a8034d0d0b073c0df3f3bd", "format-version": 4, "code-base-name": "frontend_reservation_app", "filename": "frontend_reservation_app/src/api/client.js", "fields": [{"name": "code: err?.code || undefined,", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class", "description": "unavailable"}, {"name": "code: fallback.code || \"UNKNOWN_ERROR\",", "scope": "normalizeError.base", "scopeKind": "class", "description": "unavailable"}, {"name": "details: fallback.details || undefined,", "scope": "normalizeError.base", "scopeKind": "class", "description": "unavailable"}, {"name": "hasDetails: !!err?.details,", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class", "description": "unavailable"}, {"name": "message: fallback.message || (error && error.message) || \"Unexpected error\",", "scope": "normalizeError.base", "scopeKind": "class", "description": "unavailable"}, {"name": "message: typeof err?.message === \"string\" ? \"[REDACTED_MESSAGE]\" : undefined,", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class", "description": "unavailable"}, {"name": "method,", "scope": "request.init", "scopeKind": "class", "description": "unavailable"}, {"name": "status: typeof err?.status === \"number\" ? err.status : undefined,", "scope": "sanitizeErrorForLog.safe", "scopeKind": "class", "description": "unavailable"}, {"name": "status: typeof fallback.status === \"number\" ? fallback.status : 500,", "scope": "normalizeError.base", "scopeKind": "class", "description": "unavailable"}]}